(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[190],{4465:function(t,r,e){"use strict";e.d(r,{J:function(){return p}});var n="https://js.stripe.com/v3",a=/^https:\/\/js\.stripe\.com\/v3\/?(\?.*)?$/,c=function(){for(var t=document.querySelectorAll('script[src^="'.concat(n,'"]')),r=0;r<t.length;r++){var e=t[r];if(a.test(e.src))return e}return null},i=function(t){var r=t&&!t.advancedFraudSignals?"?advancedFraudSignals=false":"",e=document.createElement("script");e.src="".concat(n).concat(r);var a=document.head||document.body;if(!a)throw Error("Expected document.body not to be null. Stripe.js requires a <body> element.");return a.appendChild(e),e},o=function(t,r){t&&t._registerWrapper&&t._registerWrapper({name:"stripe-js",version:"2.2.0",startTime:r})},s=null,d=function(t,r,e){if(null===t)return null;var n=t.apply(void 0,r);return o(n,e),n},l=Promise.resolve().then(function(){return null!==s?s:s=new Promise(function(t,r){if("undefined"==typeof window||"undefined"==typeof document){t(null);return}if(window.Stripe,window.Stripe){t(window.Stripe);return}try{var e=c();e||(e=i(null)),e.addEventListener("load",function(){window.Stripe?t(window.Stripe):r(Error("Stripe.js not available"))}),e.addEventListener("error",function(){r(Error("Failed to load Stripe.js"))})}catch(t){r(t);return}})}),u=!1;l.catch(function(t){u||console.warn(t)});var p=function(){for(var t=arguments.length,r=Array(t),e=0;e<t;e++)r[e]=arguments[e];u=!0;var n=Date.now();return l.then(function(t){return d(t,r,n)})}},1742:function(t,r,e){(window.__NEXT_P=window.__NEXT_P||[]).push(["/cart",function(){return e(5038)}])},379:function(t,r,e){"use strict";e.d(r,{g:function(){return c}});var n=e(5893),a=e(3927);let c=()=>(0,n.jsx)("div",{style:{display:"flex",justifyContent:"center",flexDirection:"column",alignItems:"center",width:"100%",height:"100vh"},children:(0,n.jsx)("div",{style:{display:"flex",justifyContent:"center"},children:(0,n.jsx)(a.Z,{})})})},5038:function(t,r,e){"use strict";e.r(r);var n=e(5893),a=e(7294),c=e(8675),i=e.n(c),o=e(5675),s=e.n(o),d=e(1163),l=e(1664),u=e.n(l),p=e(4465),h=e(4480),_=e(7533),m=e(379),C=e(3454);r.default=()=>{var t,r;(0,d.useRouter)();let e=(0,h.sJ)(_.K),[c,o]=(0,a.useState)(!1),[l,v]=(0,a.useState)([]),f=async()=>{try{let t=await (0,p.J)(C.env.NEXT_PUBLIC_PUBLISHABLE_KEY),r=l.products.map(t=>({name:t.product.name,price:t.product.price,quantity:t.quantity,productId:t.product._id})),e=await fetch("".concat(C.env.NEXT_PUBLIC_SERVER_URL,"/create-checkout-session"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("token")},body:JSON.stringify({product:r})}),n=await e.json();await t.redirectToCheckout({sessionId:n.session.id})}catch(t){alert(t.message)}};(0,a.useEffect)(()=>{j()},[]);let j=async()=>{try{let t=await fetch("".concat(C.env.NEXT_PUBLIC_SERVER_URL,"/cart"),{method:"GET",headers:{Authorization:"Bearer "+localStorage.getItem("token")}}),r=await t.json();v(r.cart),o(!0)}catch(t){console.log(t),o(!0)}};return c?e.user?(null==l?void 0:null===(t=l.products)||void 0===t?void 0:t.length)===0?(0,n.jsx)("div",{className:i().emptyCart,children:(0,n.jsx)("h1",{children:"Cart is empty!"})}):(0,n.jsxs)("div",{className:i().cartDetailsParentContainer,children:[(0,n.jsx)("h2",{className:i().heading,children:"Your Cart"}),(0,n.jsxs)("div",{className:i().cartDetailsContainer,children:[(0,n.jsxs)("div",{className:i().productsContainer,children:[(0,n.jsxs)("div",{className:i().cartProductHeading,children:[(0,n.jsx)("p",{children:"Product"}),(0,n.jsx)("p",{children:"Quantity"}),(0,n.jsx)("p",{children:"Total"}),(0,n.jsx)("p",{children:"Remove"})]}),(0,n.jsx)("hr",{className:i().horizontalLine}),null==l?void 0:null===(r=l.products)||void 0===r?void 0:r.map(t=>(0,n.jsxs)("div",{className:i().cartProductCard,children:[(0,n.jsxs)("div",{className:i().productThumbnailContainer,children:[(0,n.jsx)(s(),{className:i().productThumbnail,src:t.product.thumbnail,alt:"product image",width:100,height:100}),(0,n.jsxs)(u(),{href:"/product/".concat(t.product._id),children:[(0,n.jsx)("p",{children:t.product.name}),(0,n.jsxs)("p",{className:i().productPrice,children:["$",t.product.price]})]})]}),(0,n.jsx)("div",{className:i().productQuantity,children:t.quantity}),(0,n.jsxs)("div",{className:i().productTotal,children:["$",t.quantity*t.product.price]}),(0,n.jsx)("div",{className:i().productRemove,children:(0,n.jsx)("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACQAAAAkCAYAAADhAJiYAAAAAXNSR0IArs4c6QAAAO5JREFUWEftl8ENwyAMRZ83aTbpKpmk7STNJs0mzSZEKKoaBRLHiAOtzBVbfnxsjIXGljTGw38ABXgBV0XdSaCz3oBZoZMwH45BoLdAmYAC3IGbJQDwkMXv1EqACoOeCpYxSmAdaKOSrlCp9rX8DpM6LKWtlbeVZRQY95w0oJKq0gAPq86BtHfp9xUSvg05QMgljGJTN4ccaH0Fub7mCrlCmzI1v0OeQ55DnkNpv6vby+L3YaXy3kh0ZFMdSPsRavvNAfUCQ+mf+gK8tSMb9zuBqQgoOgWIUM8K00eEiOrsThwxnmm2NypRZO5Ammwz8j2OJWbP2wcAAAAASUVORK5CYII=",className:i().removeFromCartButton,onClick:async()=>{try{let r=await fetch("".concat(C.env.NEXT_PUBLIC_SERVER_URL,"/cart/").concat(t.product._id),{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("token")}});if(!r.ok)throw Error("HTTP error! status: ".concat(r.status));await j()}catch(t){console.error("Error:",t)}}})})]},t.product._id))]}),(0,n.jsxs)("div",{className:i().cartTotals,children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("span",{children:"Cart Total: "})," ",(0,n.jsxs)("span",{children:["$",null==l?void 0:l.totalPrice]})]}),(0,n.jsx)("button",{className:i().btn,onClick:f,children:"Check Out"})]})]})]}):(0,n.jsx)("div",{className:i().container,children:(0,n.jsx)("h1",{className:i().title,children:"Not authorised! Login to see your cart."})}):(0,n.jsx)(m.g,{})}},8675:function(t){t.exports={removeFromCartButton:"Cart_removeFromCartButton__jpHB8",emptyCart:"Cart_emptyCart__2Eyfz",heading:"Cart_heading__zAWs7",cartDetailsParentContainer:"Cart_cartDetailsParentContainer__EynSN",cartProductHeading:"Cart_cartProductHeading__E9Ntq",cartDetailsContainer:"Cart_cartDetailsContainer__pPfIL",productThumbnailContainer:"Cart_productThumbnailContainer__b1pzY",productThumbnail:"Cart_productThumbnail__tLuDy",horizontalLine:"Cart_horizontalLine___p3Hc",cartProductCard:"Cart_cartProductCard__RP_Dl",cartTotals:"Cart_cartTotals__hUfc8",checkoutBtn:"Cart_checkoutBtn__WrzhR",btn:"Cart_btn__Qp8rP",productQuantityContainer:"Cart_productQuantityContainer__qjWfP",container:"Cart_container__Wotl5",title:"Cart_title__81RBc",productPrice:"Cart_productPrice__6qJ0V"}}},function(t){t.O(0,[774,888,179],function(){return t(t.s=1742)}),_N_E=t.O()}]);